@model IEnumerable<eShopSolution.ViewModels.Catalog.Products.ProductViewModel>
@{
    ViewData["Title"] = "Admin";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="/assets/demo/chart-area-demo.js"></script>
    <script src="/assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js" crossorigin="anonymous"></script>
    <script src="/assets/demo/datatables-demo.js"></script>
}
<div class="container-fluid">
    <h1 class="mt-4">Bảng thống kê</h1>
    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item active">Dashboard</li>
    </ol>
    <div class="row">
        <div class="col-xl-3 col-md-6">
            <div class="card bg-primary text-white mb-4">
                <div class="card-body">Products</div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="#"><div>Products: @ViewBag.TotalStock</div></a>
                    <div class="small text-white"><i class="fas fa-angle-right"></i></div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card bg-warning text-white mb-4">
                <div class="card-body">Customner</div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="#"><div>User: @ViewBag.countusers</div></a>
                    <div class="small text-white"><i class="fas fa-angle-right"></i></div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card bg-success text-white mb-4">
                <div class="card-body">Oder</div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="#"><div>Order: @ViewBag.countoders</div></a>
                    <div class="small text-white"><i class="fas fa-angle-right"></i></div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card bg-danger text-white mb-4">
                <div class="card-body">total revenue</div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="#"><div>Totalrevenue: @ViewBag.totalrevenue</div></a>
                    <div class="small text-white"><i class="fas fa-angle-right"></i></div>
                </div>
            </div>
        </div>
    </div>
   
    <h1 style="text-align: center;">DIAGRAMS</h1>

    <div style="display: flex; justify-content: space-between;">
        <div style="width: 45%;">
            <h2 style="text-align: center;">Diagram 1</h2>
            <canvas id="myChart1" style="width: 100%; height: auto;"></canvas>
        </div>
        <div style="width: 45%;">
            <h2 style="text-align: center;">Diagram 2</h2>
            <canvas id="myChart2" style="width: 100%; height: auto;"></canvas>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Khai báo mảng để lưu trữ dữ liệu stock từ mỗi sản phẩm
        var stockData1 = [];
        var productIds1 = [];

        var stockData2 = [];
        var productIds2 = [];

        // Lặp qua mỗi sản phẩm trong ViewBag.Products và trích xuất dữ liệu stock
        @foreach (var item in ViewBag.Products)
        {
            <text>
                productIds1.push('@item.Id');
            stockData1.push('@item.Stock');
            </text>
        }

            // Lặp qua mỗi danh mục trong ViewBag.StockByCategory và trích xuất dữ liệu stock
        @foreach (var item in ViewBag.StockByCategory)
        {
            <text>
                productIds2.push('@item.CategoryId');
            stockData2.push('@item.TotalStock');
            </text>
        }

                // Khởi tạo biểu đồ 1 với dữ liệu đã trích xuất
                const ctx1 = document.getElementById('myChart1');

        new Chart(ctx1, {
            type: 'bar',
            data: {
                // Đặt nhãn là ID của các sản phẩm
                labels: productIds1,
                datasets: [{
                    label: 'Số lượng tồn',
                    // Sử dụng dữ liệu stock đã trích xuất
                    data: stockData1,
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            stepSize: 1
                        }
                    }
                }
            }
        });

        // Khởi tạo biểu đồ 2 với dữ liệu đã trích xuất
        const ctx2 = document.getElementById('myChart2');

        new Chart(ctx2, {
            type: 'bar',
            data: {
                // Đặt nhãn là ID của các danh mục
                labels: productIds2,
                datasets: [{
                    label: 'Tổng số lượng hàng tồn kho theo danh mục',
                    // Sử dụng dữ liệu stock đã trích xuất
                    data: stockData2,
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            stepSize: 1
                        }
                    }
                }
            }
        });
    </script>


</div>
